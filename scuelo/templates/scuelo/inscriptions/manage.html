{% extends "/home/humbu/sigpoc/templates/layout.html" %}


{% block content %}

<style>
    /* Form styles */
    .inscription-form {
        margin-bottom: 20px;
        background-color: #f9f9f9;
        padding: 20px;
        border-radius: 5px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .inscription-form label {
        display: block;
        margin-bottom: 5px;
        font-weight: bold;
    }
      /* Style for the form */
      .payment-form {
        margin-bottom: 20px;
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
    }

    .payment-form input[type="text"],
    .payment-form input[type="number"],
    .payment-form select {
        width: calc(50% - 10px);
        padding: 10px;
        margin-bottom: 10px;
        border: 1px solid #ccc;
        border-radius: 4px;
        box-sizing: border-box;
    }

    .payment-form button[type="submit"] {
        width: 100%;
        background-color: #007bff; /* Bootstrap primary color */
        color: #fff;
        padding: 10px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
    }

    .payment-form button[type="submit"]:hover {
        background-color: #0056b3; /* Darker shade of primary color on hover */
    }

    .nav-link.active {
        font-weight: bold;
    }

    .inscription-form input[type="text"],
    .inscription-form select,
    .inscription-form input[type="date"] {
        width: 100%;
        padding: 10px;
        margin-bottom: 10px;
        border: 1px solid #ccc;
        border-radius: 4px;
        box-sizing: border-box;
    }

    .inscription-form button[type="submit"] {
        width: 100%;
        background-color: #007bff; /* Bootstrap primary color */
        color: #fff;
        padding: 10px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
    }

    .inscription-form button[type="submit"]:hover {
        background-color: #0056b3; /* Darker shade of primary color on hover */
    }
</style>
<div class=''>
<h1>Manage Inscriptions</h1>


<h2>Create Inscription</h2>
    <!-- Inscription Creation Form -->

    <form method="post">
        {% csrf_token %}
        <div class="row">
            <div class="col-md-6">
                <div class="form-group">
                    <label for="id_eleve">Student</label>
                    {{ form.eleve }}
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group">
                    <label for="id_classe">Class</label>
                    {{ form.classe }}
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-6">
                <div class="form-group">
                    <label for="id_annee_scolaire">School Year</label>
                    {{ form.annee_scolaire }}
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group">
                    <label for="id_date_inscription">Date of Inscription</label>
                    {{ form.date_inscription }}
                </div>
            </div>
        </div>
        <button type="submit" class="mt-2 btn btn-primary">Create Inscription</button>
    </form>
<!-- Display statistics in a styled manner -->
<div class="row mb-4">
    <div class="col-md-4">
        <div class="card">
            <div class="card-body">
                <h3 class="card-title">Total Inscriptions</h3>
                <p class="card-text">{{ total_inscriptions }}</p>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card">
            <div class="card-body">
                <h4 class="card-title">Inscriptions per Class</h4>
                <ul class="list-group list-group-flush">
                    {% for entry in inscriptions_per_class %}
                    <li class="list-group-item">{{ entry.classe__nom }}: {{ entry.total }}</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card">
            <div class="card-body">
                <h4 class="card-title">Inscriptions per School Year</h4>
                <ul class="list-group list-group-flush">
                    {% for entry in inscriptions_per_year %}
                    <li class="list-group-item">{{ entry.annee_scolaire__nom }}: {{ entry.total }}</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
</div>
</div>
<!-- Navigation for Inscriptions -->
<ul class="nav nav-tabs mb-4">
    <li class="nav-item">
        <a class="nav-link {% if not class_filter %}active{% endif %}" href="{% url 'manage_inscriptions' %}">All Classes</a>
    </li>
    {% for classe in classes %}
    <li class="nav-item">
        <a class="nav-link {% if class_filter == classe.nom %}active{% endif %}" href="{% url 'manage_inscriptions' %}?class={{ classe.nom }}">{{ classe.nom }}</a>
    </li>
    {% endfor %}
</ul>
<!-- Filter toggle buttons -->
<div class="btn-group" role="group" aria-label="School Year Filter">
    {% for year in school_years %}
    <button type="button" class="btn btn-secondary toggle-btn" data-year="{{ year }}">{{ year }}</button>
    {% endfor %}
</div>
    <table class="table table-striped table-bordered payments-table">
        <thead class="thead-light">
            <tr>
                <th scope="col">Student</th>
                <th scope="col">Class</th>
                <th scope="col">School Year</th>
                <th scope="col">Date of Inscription</th>
                <th scope="col">Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for inscription in inscriptions %}
            <tr>
                <td>{{ inscription.eleve.nom }} {{ inscription.eleve.prenom }}</td>
                <td>{{ inscription.classe.nom }}</td>
                <td>{{ inscription.annee_scolaire.nom }}</td>
                <td>{{ inscription.date_inscription }}</td>
                <td>
                    <a href="{% url 'update_inscription' inscription.pk %}" class="btn btn-warning btn-sm">Update</a>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="4">No inscriptions found.</td>
            </tr>
            {% endfor %}
            
        </tbody>
    </table>
</div>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Get all toggle buttons
        const toggleButtons = document.querySelectorAll('.toggle-btn');
    
        // Add click event listener to each toggle button
        toggleButtons.forEach(button => {
            button.addEventListener('click', function() {
                const year = this.dataset.year; // Get the selected school year
                const inscriptions = document.querySelectorAll('.inscription');
    
                // Loop through all inscriptions
                inscriptions.forEach(inscription => {
                    // Show or hide inscription based on the selected year
                    if (year === 'all' || inscription.dataset.year === year) {
                        inscription.style.display = 'block';
                    } else {
                        inscription.style.display = 'none';
                    }
                });
            });
        });
    });
    </script>
    
{% endblock %}