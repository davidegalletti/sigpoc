{% extends "/home/humbu/sigpoc/templates/layout.html" %}

{% block header %}
<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container-fluid">
        <a class="navbar-brand" href="#">Your Logo</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                <!-- Other Navbar Links -->
            </ul>
            <!-- Display statistics -->
            <div class="row">
                <div class="col-md-4">
                    <div class="card">
                        <div class="card-body">
                            <h3 class="card-title">Total Inscriptions</h3>
                            <p class="card-text">{{ total_inscriptions }}</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card">
                        <div class="card-body">
                            <h4 class="card-title">Inscriptions par  Classe</h4>
                            <ul class="list-group list-group-flush">
                                {% for entry in inscriptions_per_class %}
                                <li class="list-group-item">{{ entry.classe__nom }}: {{ entry.total }}</li>
                                {% endfor %}
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card">
                        <div class="card-body">
                            <h4 class="card-title">Inscriptions par annee Scolaire</h4>
                            <ul class="list-group list-group-flush">
                                {% for entry in inscriptions_per_year %}
                                <li class="list-group-item">{{ entry.annee_scolaire__nom }}: {{ entry.total }}</li>
                                {% endfor %}
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</nav>

{% endblock header %}

{% block content %}

<style>
    /* Form styles */
    .inscription-form {
        margin-bottom: 20px;
        background-color: #f9f9f9;
        padding: 20px;
        border-radius: 5px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .inscription-form label {
        display: block;
        margin-bottom: 5px;
        font-weight: bold;
    }
      /* Style for the form */
      .payment-form {
        margin-bottom: 20px;
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
    }

    .payment-form input[type="text"],
    .payment-form input[type="number"],
    .payment-form select {
        width: calc(50% - 10px);
        padding: 10px;
        margin-bottom: 10px;
        border: 1px solid #ccc;
        border-radius: 4px;
        box-sizing: border-box;
    }

    .payment-form button[type="submit"] {
        width: 100%;
        background-color: #007bff; /* Bootstrap primary color */
        color: #fff;
        padding: 10px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
    }

    .payment-form button[type="submit"]:hover {
        background-color: #0056b3; /* Darker shade of primary color on hover */
    }

    .nav-link.active {
        font-weight: bold;
    }

    .inscription-form input[type="text"],
    .inscription-form select,
    .inscription-form input[type="date"] {
        width: 100%;
        padding: 10px;
        margin-bottom: 10px;
        border: 1px solid #ccc;
        border-radius: 4px;
        box-sizing: border-box;
    }

    .inscription-form button[type="submit"] {
        width: 100%;
        background-color: #007bff; /* Bootstrap primary color */
        color: #fff;
        padding: 10px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
    }

    .inscription-form button[type="submit"]:hover {
        background-color: #0056b3; /* Darker shade of primary color on hover */
    }
</style>
<div class='content'>
<h1>Manage Inscriptions</h1>


<h2> ajouter Inscription</h2>
    <!-- Inscription Creation Form -->

    <form method="post">
        {% csrf_token %}
        <div class="row">
            <div class="col-md-6">
                <div class="form-group">
                    <label for="id_eleve">Eleve</label>
                    {{ form.eleve }}
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group">
                    <label for="id_classe">Classe</label>
                    {{ form.classe }}
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-6">
                <div class="form-group">
                    <label for="id_annee_scolaire">Annee scolaire</label>
                    {{ form.annee_scolaire }}
                </div>
            </div>
         
        </div>
        <button type="submit" class="mt-2 btn btn-primary mb-5">Ajouter Inscription</button>
    </form>

</div class='mb-5'>
<!-- Navigation for Inscriptions -->
<ul class="nav nav-tabs mb-4">
    <li class="nav-item">
        <a class="nav-link {% if not class_filter %}active{% endif %}" href="{% url 'manage_inscriptions' %}">Toutes les  Classes</a>
    </li>
    {% for classe in classes %}
    <li class="nav-item">
        <a class="nav-link {% if class_filter == classe.nom %}active{% endif %}" href="{% url 'manage_inscriptions' %}?class={{ classe.nom }}">{{ classe.nom }}</a>
    </li>
    {% endfor %}
</ul>
<!-- Filter toggle buttons -->
<div class="btn-group" role="group" aria-label="School Year Filter">
    {% for year in school_years %}
    <button type="button" class="btn btn-secondary toggle-btn" data-year="{{ year }}">{{ year }}</button>
    {% endfor %}
</div>
    <table class=" table table-striped table-bordered payments-table  w-95  ">
        <thead class="thead-light">
            <tr class="p-5">
                <th scope="col">Eleve</th>
                <th scope="col">Classe</th>
                <th scope="col">Annee scolaire</th>
                <th scope="col">Date d'inscription</th>
                <th scope="col">Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for inscription in inscriptions %}
            <tr>
                <td>{{ inscription.eleve.nom }} {{ inscription.eleve.prenom }}</td>
                <td>{{ inscription.classe.nom }}</td>
                <td>{{ inscription.annee_scolaire.nom }}</td>
                <td>{{ inscription.date_inscription }}</td>
                <td>
                    <a href="{% url 'update_inscription' inscription.pk %}" class="btn btn-warning btn-sm">Update</a>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="4">aucun inscription trouver  </td>
            </tr>
            {% endfor %}
            
        </tbody>
    </table>
</div>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Get all toggle buttons
        const toggleButtons = document.querySelectorAll('.toggle-btn');
    
        // Add click event listener to each toggle button
        toggleButtons.forEach(button => {
            button.addEventListener('click', function() {
                const year = this.dataset.year; // Get the selected school year
                const inscriptions = document.querySelectorAll('.inscription');
    
                // Loop through all inscriptions
                inscriptions.forEach(inscription => {
                    // Show or hide inscription based on the selected year
                    if (year === 'all' || inscription.dataset.year === year) {
                        inscription.style.display = 'block';
                    } else {
                        inscription.style.display = 'none';
                    }
                });
            });
        });
    });
    </script>
    
{% endblock %}